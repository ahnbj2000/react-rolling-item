{"version":3,"sources":["rolling-item/rolling-item.module.scss","images/french-fries.png","../node_modules/webpack/hot sync nonrecursive /^/.//log$","utils/rAF.js","rolling-item/index.tsx","Container.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["module","exports","rolling","inner","box","__webpack_require__","p","map","./log","webpackContext","req","id","webpackContextResolve","o","e","Error","code","keys","Object","resolve","lastTime","vendors","x","length","window","requestAnimationFrame","cancelAnimationFrame","callback","element","currTime","Date","getTime","timeToCall","Math","max","setTimeout","clearTimeout","RAF_DELAY","RollingBox","styled","div","_templateObject","props","concat","width","height","BoxDiv","attrs","style","transform","pos","msTransform","_templateObject2","css","_templateObject3","animation","RollingImages","_templateObject4","backgroundImage","backgroundSize","y","RollingItem","context","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","rollingRafId","loopRafId","boxHeight","movePixel","stopDelay","resultId","shuffle","shufflePos","toConsumableArray","forEach","v","i","randomIndex","floor","random","_ref","animate","index","arguments","undefined","state","on","next","now","setState","itemInfo","some","abs","selectedItem","eachAnimationState","cancel","onProgress","every","animationState","bind","assertThisInitialized","splice","Array","row","fill","_this2","eachPos","push","prevProps","prevState","_this3","execCount","detect","name","_this4","_this$props","_this$props$completio","completionAnimation","_this$state","rollingBoxes","frame","keyframes","_templateObject5","react","assign","className","classNames","styles","key","React","Container","onClick","start","rolling_item_RollingItem","imageFile","isProgress","result","console","log","App","react_default","a","createElement","Container_Container","Boolean","location","hostname","match","ReactDOM","render","src_App_0","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.964bd647.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"rolling\":\"rolling-item_rolling__1Uoa9\",\"inner\":\"rolling-item_inner__2FpXf\",\"box\":\"rolling-item_box__QwRFF\"};","module.exports = __webpack_public_path__ + \"static/media/french-fries.9d33107d.png\";","var map = {\n\t\"./log\": 260\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 259;","// http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n// http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating\n\n// requestAnimationFrame polyfill by Erik Möller. fixes from Paul Irish and Tino Zijdel\n\n// MIT license\n\n(function() {\n  var lastTime = 0;\n  var vendors = ['ms', 'moz', 'webkit', 'o'];\n  for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n      window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];\n      window.cancelAnimationFrame = window[vendors[x]+'CancelAnimationFrame']\n                                 || window[vendors[x]+'CancelRequestAnimationFrame'];\n  }\n\n  if (!window.requestAnimationFrame)\n      window.requestAnimationFrame = function(callback, element) {\n          var currTime = new Date().getTime();\n          var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n          var id = window.setTimeout(function() { callback(currTime + timeToCall); },\n            timeToCall);\n          lastTime = currTime + timeToCall;\n          return id;\n      };\n\n  if (!window.cancelAnimationFrame)\n      window.cancelAnimationFrame = function(id) {\n          clearTimeout(id);\n      };\n}());","import * as React from 'react';\nimport styles from './rolling-item.module.scss';\nimport styled, { css, keyframes } from 'styled-components';\nimport { detect } from 'detect-browser';\nimport classNames from 'classnames';\n\ntype ItemInfo = {x: string | number, y: string | number, id?: any};\ninterface IRollingItemProps {\n  on: boolean;\n  row: number;\n  backgroundImage: string;\n  backgroundSize: string;\n  itemInfo: ItemInfo[];\n  width: number;\n  height: number;\n  completionAnimation?: boolean;\n  onProgress?: (progress: boolean, result?: any[]) => void;\n}\n\ninterface IRollingItemState {\n  on: boolean;\n  animationState: boolean;\n  eachAnimationState: boolean[];\n  pos: number[];\n  itemInfo: ItemInfo[][];\n}\n\nconst RAF_DELAY = 1;\n\nconst RollingBox: any = styled.div<any>`\n  width: ${props => `${props.width}px`};\n  height: ${props => `${props.height}px`};\n`;\n\n// const BoxDiv: any = styled.div<any>`\n//   transform: ${props => `translate(0px, ${props.pos}px)`};\n//   animation: ${props => css`${props.animation} 1s ease 1`};\n// `;\n\n// 연속적인 transform animation 속성의 경우 위와 같이 작성하면 픽셀 변경 시마다 새로운 className(styled-components에서 생성하는)이\n// 매번 생성되어 perfomance 오류가 발생\n// 이를 피하려면 attrs 메소드를 사용한다.\nconst BoxDiv: any = styled.div.attrs<any>((props) => ({\n  style: {\n    transform: `translate(0px, ${props.pos}px)`,\n    msTransform: `translate(0px, ${props.pos}px)`,\n  }\n}))`\n  ${(props: any) => css`animation: ${props.animation} 0.6s ease-out 1`};\n`;\n\nconst RollingImages: any = styled.div<any>`\n  background: url(${props => props.backgroundImage});\n  background-size: ${props => props.backgroundSize};\n  background-position: ${props => typeof props.pos.x === 'number' ? `${props.pos.x}px` : props.pos.x} ${props => typeof props.pos.y === 'number' ? `${props.pos.y}px` : props.pos.y};\n  width: ${props => `${props.width}px`};\n  height: ${props => `${props.height}px`};\n`;\n\nexport default class RollingItem extends React.PureComponent<IRollingItemProps, IRollingItemState> {\n  private rollingRafId: any[] = [];\n  private loopRafId: any = null;\n  private boxHeight: number = 0;\n  private movePixel: number[] = [];\n  private stopDelay: number[] = [];\n  private resultId: any[] = [];\n\n  static getDerivedStateFromProps(props: IRollingItemProps, state: IRollingItemState) {\n    if (state.pos.length == 0) {\n      return {\n        pos: Array(props.row).fill(-(props.height * props.itemInfo.length)),\n        itemInfo: Array(props.row).fill([...props.itemInfo]),\n      }\n    }\n\n    if (props.on !== state.on) {\n      return {\n        on: props.on && !state.animationState,\n      }\n    }\n\n    return null;\n  }\n\n  /* tslint:disable:no-console */\n  constructor(props: IRollingItemProps, context?: any) {\n    super(props, context);\n\n    this.state = {\n      on: false,\n      animationState: false,\n      eachAnimationState: [false, false, false],\n      pos: [],\n      itemInfo: [],\n    }\n  }\n\n  public componentDidMount(): void {\n    const { itemInfo } = this.state;\n    const shufflePos: ItemInfo[][] = [];\n\n    this.boxHeight = this.props.height * this.props.itemInfo.length;\n\n    itemInfo.forEach((eachPos) => {\n      shufflePos.push(this.shuffle(eachPos));\n    });\n\n    this.setState({\n      itemInfo: shufflePos,\n    });\n  }\n\n  public componentDidUpdate(prevProps: IRollingItemProps, prevState: IRollingItemState): void {\n    if (prevState.on !== this.state.on) {\n      if (this.state.on) {\n        this.setState({ animationState: true });\n\n        let execCount = 0;\n        const callback = (next?: any) => {\n          let now = new Date().getTime();\n          if (typeof next === 'undefined' || now > next && execCount < this.props.row) {\n            this.stopDelay[execCount] = execCount * 50;\n            this.cancel(execCount);\n            this.movePixel[execCount] = ((detect() as any).name === 'ie' ? 20 : 10) * this.props.height * 0.01;\n            this.animate(execCount);\n            next = now;\n          }\n          execCount++;\n\n          if (execCount === 3) {\n            cancelAnimationFrame(this.loopRafId);\n          } else {\n            this.loopRafId = requestAnimationFrame(callback.bind(this, next));\n          }\n        }\n\n        this.loopRafId = requestAnimationFrame(callback);\n\n        if (this.props.onProgress) {\n          this.props.onProgress(true);\n        }\n      }\n    }\n  }\n\n  public render(): React.ReactNode {\n    const { backgroundImage, backgroundSize, width, height, completionAnimation = false } = this.props;\n    const { itemInfo, eachAnimationState } = this.state;\n    const rollingBoxes: any[] = [];\n\n    itemInfo.forEach((eachPos, i) => {\n      let frame = eachAnimationState[i] && completionAnimation ? keyframes`\n        50% { transform: translate(0, ${this.state.pos[i]+30 }px); }\n        100% { transform: translate(0, ${this.state.pos[i] }px); }\n      ` : null;\n\n      rollingBoxes.push(\n        <RollingBox className={classNames(styles.box, 'roll_box_item')} {...{ width, height }} key={i}>\n          <BoxDiv\n            { ...{ pos: this.state.pos[i], animation: frame } }\n            key={`inner_${i}`}\n          >\n            {\n              eachPos.map(\n                (pos, i) => <RollingImages {...{ pos, backgroundImage, backgroundSize, width, height }} key={i} />\n              )\n            }\n            <RollingImages {...{ pos: eachPos[0], backgroundImage, backgroundSize, width, height }} key={i} />\n          </BoxDiv>\n        </RollingBox>\n      );\n    });\n\n    return (\n      <div className={classNames(styles.rolling, 'roll_box_wrap')}>\n        <div className={classNames(styles.inner, 'roll_box_inner')}>\n          {rollingBoxes}\n        </div>\n      </div>\n    );\n  }\n\n  private shuffle = (pos: ItemInfo[]): ItemInfo[] => {\n    const shufflePos = [...pos];\n\n    shufflePos.forEach((v, i) => {\n      const randomIndex = Math.floor(Math.random() * (i + 1));\n      [shufflePos[i], shufflePos[randomIndex]] = [shufflePos[randomIndex], shufflePos[i]];\n    });\n\n    return shufflePos;\n  }\n\n  private animate = (index: number = 0): void => {\n    let pos = this.state.pos[index];\n\n    const callback = (next?: any) => {\n      let now = new Date().getTime();\n\n      if (!this.state.on) {\n        if (this.stopDelay[index] === 0) {\n          if (this.movePixel[index] > 5) {\n            this.movePixel[index] = this.movePixel[index]-=1;\n          } else {\n            if (this.state.pos[index] % this.props.height !== 0) {\n              this.movePixel[index] = 5;\n            } else {\n              if (index !== 0 && this.movePixel[index - 1] !== 0) {\n                this.movePixel[index] = 5;\n              } else {\n                this.movePixel[index] = 0;\n              }\n            }\n          }\n        }\n\n        if (this.stopDelay[index] > 0) {\n          this.stopDelay[index]--;\n        }\n      }\n\n      if (typeof next === 'undefined' || now > next) {\n        this.setState({\n          pos: this.state.pos.map((v, i) => {\n            if (i === index) {\n              return Math.floor(pos+=this.movePixel[index]);\n            } else {\n              return v;\n            }\n          }),\n        });\n        next = now + RAF_DELAY;\n      }\n\n      if (Math.floor(this.state.pos[index]) >= 0) {\n        this.setState({\n          pos: this.state.pos.map((v, i) => {\n            if (i === index) {\n              return -this.boxHeight;\n            } else {\n              return v;\n            }\n          }),\n        });\n        next = undefined;\n        pos = -this.boxHeight;\n      }\n\n      if (this.movePixel[index] === 0) {\n        const itemInfo = this.state.itemInfo[index];\n        itemInfo.some((v, i) => {\n          if ((i + 1) === Math.abs(this.state.pos[index]) / this.props.height) {\n            let selectedItem = itemInfo[i + 1];\n            if (!selectedItem) {\n              selectedItem = itemInfo[0];\n            }\n            this.resultId[index] = selectedItem.id || i;\n            return true;\n          }\n          return false;\n        });\n\n        this.setState({\n          eachAnimationState: this.state.eachAnimationState.map((v, i) => {\n            return index === i || !!v;\n          })\n        });\n\n        this.cancel(index);\n        if (this.props.onProgress && this.rollingRafId.every((v) => v === null)) {\n          this.props.onProgress(false, this.resultId);\n          this.setState({ animationState: false });\n          this.resultId = [];\n        }\n      } else {\n        this.rollingRafId[index] = requestAnimationFrame(callback.bind(this, next));\n      }\n    };\n\n    if (this.state.on) {\n      this.rollingRafId[index] = requestAnimationFrame(callback);\n    }\n  }\n\n  private cancel = (index: number): void => {\n    cancelAnimationFrame(this.rollingRafId[index]);\n    this.rollingRafId.splice(index, 1, null);\n  }\n}\n\n","import * as React from 'react';\nimport RollingItem from './rolling-item';\n\n// import imageFile from './images/spr_machine_rolling.png';\nimport imageFile from './images/french-fries.png';\n\ninterface IContainerProps {\n\n}\n\ninterface IContainerState {\n  start: boolean;\n}\nexport default class Container extends React.PureComponent<IContainerProps, IContainerState> {\n\n  constructor(props: IContainerProps, context?: any) {\n    super(props, context);\n\n    this.state = {\n      start: false,\n    };\n    this.onClick = this.onClick.bind(this);\n  }\n\n  public render(): React.ReactNode {\n\n    return (\n      <>\n        <RollingItem\n          on={this.state.start}\n          row={3}\n          backgroundImage={imageFile}\n          backgroundSize=\"1280px 640px\"\n          itemInfo={\n            [\n              { x: 0, y: -63, id: 'item_0' },\n              { x: -267, y: -63, id: 'item_1' },\n              { x: -536, y: -63, id: 'item_2' },\n              { x: -803, y: -63, id: 'item_3' },\n              { x: -1070, y: -63, id: 'item_4' },\n              { x: 0, y: -365, id: 'item_5' },\n              { x: -267, y: -365, id: 'item_6' },\n              { x: -536, y: -365, id: 'item_7' },\n              { x: -803, y: -365, id: 'item_8' },\n              { x: -1070, y: -365, id: 'item_9' }\n            ]\n          }\n          width={210}\n          height={210}\n          completionAnimation={true}\n          onProgress={(isProgress, result) => { console.log(result); }}\n        />\n        <button className=\"start_btn\" onClick={this.onClick}>{!this.state.start ? 'START' : 'STOP'}</button>\n      </>\n    );\n  }\n\n  public onClick = (e: any) => {\n    this.setState({ start: !this.state.start }, () => {\n      setTimeout(() => {\n        this.setState({ start: !this.state.start });\n      }, 1500);\n    });\n  }\n}","import React from 'react';\nimport Container from './Container';\nimport './App.scss';\n\nconst App: React.FC = () => {\n  // const imageFile = `${process.env.PUBLIC_URL}/images/spr_machine_rolling.png`;\n\n  return (\n    <div className=\"App\">\n      <Container />\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import 'core-js/es/map';\nimport 'core-js/es/set';\nimport 'react-app-polyfill/ie9';\nimport 'react-app-polyfill/stable';\nimport 'raf/polyfill';\nimport './utils/rAF.js';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}